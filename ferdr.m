function [h]=ferdr(x,k)
%
% compute Fermi integrals of order k=1/2,-1/2,3/2
%
p1=[-1.253314128820d+0, -1.723663557701d+0, -6.559045729258d-1, -6.342283197682d-2, -1.488383106116d-5];
q1=[+1.000000000000d+0, +2.191780925980d+0, +1.605812955406d+0, +4.443669527481d-1, +3.624232288112d-2];
p2=[-3.133285305570d-1, -4.161873852293d-1, -1.502208400588d-1, -1.339579375173d-2, -1.513350700138d-5];
q2=[+1.000000000000d+0, +1.872608675902d+0, +1.145204446578d+0, +2.570225587573d-1, +1.639902543568d-2];
p3=[-2.349963985406d-1, -2.927373637547d-1, -9.883097588738d-2, -8.251386379551d-3, -1.874384153223d-5];
q3=[+1.000000000000d+0, +1.608597109146d+0, +8.275289530880d-1, +1.522322382850d-1, +7.695120475064d-3];
p4=[+1.0738127694d+0, +5.6003303660d+0, +3.6882211270d+0, +1.1743392816d+0, +2.3641935527d-1];
q4=[+1.0000000000d+0, +4.6031840667d+0, +4.3075910674d-1, +4.2151132145d-1, +1.1832601601d-2];
p5=[+6.78176626660d-1, +6.33124017910d-1, +2.94479651772d-1, +8.01320711419d-2, +1.33918212940d-2];
q5=[+1.00000000000d+0, +1.43740400397d-1, +7.08662148450d-2, +2.34579494735d-3, -1.29449928835d-5];
p6=[+1.1530213402d+0, +1.0591558972d+0, +4.6898803095d-1, +1.1882908784d-1, +1.9438755787d-2];
q6=[+1.0000000000d+0, +3.7348953841d-2, +2.3248458137d-2, -1.3766770874d-3, +4.6466392781d-5];
p7=[-8.222559330d-1, -3.620369345d+1, -3.015385410d+3, -7.049871579d+4, -5.698145924d+4];
q7=[+1.000000000d+0, +3.935689841d+1, +3.568756266d+3, +4.181893625d+4, +3.385138907d+5];
p8=[+8.2244997626d-1, +2.0046303393d+1, +1.8268093446d+3, +1.2226530374d+4, +1.4040750092d+5];
q8=[+1.0000000000d+0, +2.3486207659d+1, +2.2013483743d+3, +1.1442673596d+4, +1.6584715900d+5];
p9=[+2.46740023684d+0, +2.19167582368d+2, +1.23829379075d+4, +2.20667724968d+5, +8.49442920034d+5];
q9=[+1.00000000000d+0, +8.91125140619d+1, +5.04575669667d+3, +9.09075946304d+4, +3.89960915641d+5];
c1=1.77245385090551603D0; c2=0.88622692545275801D0;
c3=1.32934038817913702D0; c4=0.66666666666666667D0;
c5=0.40000000000000000D0;
%
ii=(x<=1); jj=(x>1)&(x<=4); kk=not(ii|jj); h=[];
%
if(k==-1/2), % Fermi integral of order -1/2
y=exp(x(ii));
h(ii)=y.*(c1+y.*(p1(1)+y.*(p1(2)+y.*(p1(3)+y.*(p1(4)+y.*p1(5)))))./ ...
   (q1(1)+y.*(q1(2)+y.*(q1(3)+y.*(q1(4)+y.*q1(5))))));
h(jj)=(p4(1)+x(jj).*(p4(2)+x(jj).*(p4(3)+x(jj).*(p4(4)+x(jj).*p4(5)))))./ ...
   (q4(1)+x(jj).*(q4(2)+x(jj).*(q4(3)+x(jj).*(q4(4)+x(jj).*q4(5)))));
y=1./x(kk).^2;
h(kk)=sqrt(x(kk)).*(2+y.*(p7(1)+y.*(p7(2)+y.*(p7(3)+y.*(p7(4)+y.*p7(5)))))./ ...
   (q7(1)+y.*(q7(2)+y.*(q7(3)+y.*(q7(4)+y.*q7(5))))));
%
elseif(k==1/2), % Fermi integral of order 1/2
y=exp(x(ii));
h(ii)=y.*(c2+y.*(p2(1)+y.*(p2(2)+y.*(p2(3)+y.*(p2(4)+y.*p2(5)))))./ ...
   (q2(1)+y.*(q2(2)+y.*(q2(3)+y.*(q2(4)+y.*q2(5))))));
h(jj)=(p5(1)+x(jj).*(p5(2)+x(jj).*(p5(3)+x(jj).*(p5(4)+x(jj).*p5(5)))))./ ...
   (q5(1)+x(jj).*(q5(2)+x(jj).*(q5(3)+x(jj).*(q5(4)+x(jj).*q5(5)))));
y=1./x(kk).^2;
h(kk)=x(kk).*sqrt(x(kk)).*(c4+y.*(p8(1)+y.*(p8(2)+y.*(p8(3)+y.*(p8(4)+y.*p8(5)))))./ ...
   (q8(1)+y.*(q8(2)+y.*(q8(3)+y.*(q8(4)+y.*q8(5))))));
%
elseif(k==3/2), % Fermi integral of order 3/2
y=exp(x(ii));
h(ii)=y.*(c3+y.*(p3(1)+y.*(p3(2)+y.*(p3(3)+y.*(p3(4)+y.*p3(5)))))./ ...
   (q3(1)+y.*(q3(2)+y.*(q3(3)+y.*(q3(4)+y.*q3(5))))));
h(jj)=(p6(1)+x(jj).*(p6(2)+x(jj).*(p6(3)+x(jj).*(p6(4)+x(jj).*p6(5)))))./ ...
   (q6(1)+x(jj).*(q6(2)+x(jj).*(q6(3)+x(jj).*(q6(4)+x(jj).*q6(5)))));
y=1./x(kk).^2;
h(kk)=x(kk).^2.*sqrt(x(kk)).*(c5+y.*(p9(1)+y.*(p9(2)+y.*(p9(3)+y.*(p9(4)+y.*p9(5)))))./ ...
   (q9(1)+y.*(q9(2)+y.*(q9(3)+y.*(q9(4)+y.*q9(5))))));
end
%
h=1/gamma(k+1)*h;
% *********************************************************************************************100
