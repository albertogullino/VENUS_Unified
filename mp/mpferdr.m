function [h]=mpferdr(x,k)
%
% compute fermi integrals of order k=1/2,-1/2,3/2
%
p1=mp('[-1.253314128820e+0, -1.723663557701e+0, -6.559045729258e-1, -6.342283197682e-2, -1.488383106116e-5]');
q1=mp('[+1.000000000000e+0, +2.191780925980e+0, +1.605812955406e+0, +4.443669527481e-1, +3.624232288112e-2]');
p2=mp('[-3.133285305570e-1, -4.161873852293e-1, -1.502208400588e-1, -1.339579375173e-2, -1.513350700138e-5]');
q2=mp('[+1.000000000000e+0, +1.872608675902e+0, +1.145204446578e+0, +2.570225587573e-1, +1.639902543568e-2]');
p3=mp('[-2.349963985406e-1, -2.927373637547e-1, -9.883097588738e-2, -8.251386379551e-3, -1.874384153223e-5]');
q3=mp('[+1.000000000000e+0, +1.608597109146e+0, +8.275289530880e-1, +1.522322382850e-1, +7.695120475064e-3]');
p4=mp('[+1.0738127694e+0, +5.6003303660e+0, +3.6882211270e+0, +1.1743392816e+0, +2.3641935527e-1]');
q4=mp('[+1.0000000000e+0, +4.6031840667e+0, +4.3075910674e-1, +4.2151132145e-1, +1.1832601601e-2]');
p5=mp('[+6.78176626660e-1, +6.33124017910e-1, +2.94479651772e-1, +8.01320711419e-2, +1.33918212940e-2]');
q5=mp('[+1.00000000000e+0, +1.43740400397e-1, +7.08662148450e-2, +2.34579494735e-3, -1.29449928835e-5]');
p6=mp('[+1.1530213402e+0, +1.0591558972e+0, +4.6898803095e-1, +1.1882908784e-1, +1.9438755787e-2]');
q6=mp('[+1.0000000000e+0, +3.7348953841e-2, +2.3248458137e-2, -1.3766770874e-3, +4.6466392781e-5]');
p7=mp('[-8.222559330e-1, -3.620369345e+1, -3.015385410e+3, -7.049871579e+4, -5.698145924e+4]');
q7=mp('[+1.000000000e+0, +3.935689841e+1, +3.568756266e+3, +4.181893625e+4, +3.385138907e+5]');
p8=mp('[+8.2244997626e-1, +2.0046303393e+1, +1.8268093446e+3, +1.2226530374e+4, +1.4040750092e+5]');
q8=mp('[+1.0000000000e+0, +2.3486207659e+1, +2.2013483743e+3, +1.1442673596e+4, +1.6584715900e+5]');
p9=mp('[+2.46740023684e+0, +2.19167582368e+2, +1.23829379075e+4, +2.20667724968e+5, +8.49442920034e+5]');
q9=mp('[+1.00000000000e+0, +8.91125140619e+1, +5.04575669667e+3, +9.09075946304e+4, +3.89960915641e+5]');
c1=mp('1.77245385090551603'); 
c2=mp('0.88622692545275801');
c3=mp('1.32934038817913702'); 
c4=mp('2/3');
c5=mp('0.4');

ii=(x<=mp('1')); jj=(x>mp('1'))&(x<=mp('4')); kk=not(ii|jj); 
h=mp('0')*ones(size(x));
%
if(k==-1/2), % fermi integral of order -1/2
y=exp(x(ii));
h(ii)=y.*(c1+y.*(p1(1)+y.*(p1(2)+y.*(p1(3)+y.*(p1(4)+y.*p1(5)))))./ ...
   (q1(1)+y.*(q1(2)+y.*(q1(3)+y.*(q1(4)+y.*q1(5))))));
h(jj)=(p4(1)+x(jj).*(p4(2)+x(jj).*(p4(3)+x(jj).*(p4(4)+x(jj).*p4(5)))))./ ...
   (q4(1)+x(jj).*(q4(2)+x(jj).*(q4(3)+x(jj).*(q4(4)+x(jj).*q4(5)))));
y=mp('1')./x(kk).^mp('2');
h(kk)=sqrt(x(kk)).*(mp('2')+y.*(p7(1)+y.*(p7(2)+y.*(p7(3)+y.*(p7(4)+y.*p7(5)))))./ ...
   (q7(1)+y.*(q7(2)+y.*(q7(3)+y.*(q7(4)+y.*q7(5))))));
%
elseif(k==1/2), % fermi integral of order 1/2
y=exp(x(ii));
h(ii)=y.*(c2+y.*(p2(1)+y.*(p2(2)+y.*(p2(3)+y.*(p2(4)+y.*p2(5)))))./ ...
   (q2(1)+y.*(q2(2)+y.*(q2(3)+y.*(q2(4)+y.*q2(5))))));
h(jj)=(p5(1)+x(jj).*(p5(2)+x(jj).*(p5(3)+x(jj).*(p5(4)+x(jj).*p5(5)))))./ ...
   (q5(1)+x(jj).*(q5(2)+x(jj).*(q5(3)+x(jj).*(q5(4)+x(jj).*q5(5)))));
y=1./x(kk).^mp('2');
h(kk)=x(kk).*sqrt(x(kk)).*(c4+y.*(p8(1)+y.*(p8(2)+y.*(p8(3)+y.*(p8(4)+y.*p8(5)))))./ ...
   (q8(1)+y.*(q8(2)+y.*(q8(3)+y.*(q8(4)+y.*q8(5))))));
%
elseif(k==3/2), % fermi integral of order 3/2
y=exp(x(ii));
h(ii)=y.*(c3+y.*(p3(1)+y.*(p3(2)+y.*(p3(3)+y.*(p3(4)+y.*p3(5)))))./ ...
   (q3(1)+y.*(q3(2)+y.*(q3(3)+y.*(q3(4)+y.*q3(5))))));
h(jj)=(p6(1)+x(jj).*(p6(2)+x(jj).*(p6(3)+x(jj).*(p6(4)+x(jj).*p6(5)))))./ ...
   (q6(1)+x(jj).*(q6(2)+x(jj).*(q6(3)+x(jj).*(q6(4)+x(jj).*q6(5)))));
y=mp('1')./x(kk).^mp('2');
h(kk)=x(kk).^mp('2').*sqrt(x(kk)).*(c5+y.*(p9(1)+y.*(p9(2)+y.*(p9(3)+y.*(p9(4)+y.*p9(5)))))./ ...
   (q9(1)+y.*(q9(2)+y.*(q9(3)+y.*(q9(4)+y.*q9(5))))));
end
%
arggamma=k+mp('1');
h=mp('1')/gamma(arggamma)*h;